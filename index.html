<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ุณุฌู ุงูุนูุงู - ุชุทุจูู ุฐูู</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1a2a6c">
    <link rel="apple-touch-icon" href="https://cdn-icons-png.flaticon.com/512/3790/3790539.png">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div id="installBanner" class="install-banner" style="display: none;">
    <div class="d-flex align-items-center justify-content-between">
        <div class="d-flex align-items-center">
            <img src="https://cdn-icons-png.flaticon.com/512/3790/3790539.png" alt="App Icon" style="width: 40px; height: 40px; margin-left: 10px;">
            <div>
                <h6 class="m-0 fw-bold text-white">ุชุทุจูู ุณุฌู ุงูุนูุงู</h6>
                <small class="text-white-50">ุซุจุชู ุงูุขู ููุนูู ุจุฏูู ุฅูุชุฑูุช</small>
            </div>
        </div>
        <div>
            <button class="btn btn-sm btn-light text-dark fw-bold ms-2" onclick="installPWA()">ุชุซุจูุช</button>
            <button class="btn btn-sm btn-outline-light" onclick="hideInstallBanner()">ูุงุญูุงู</button>
        </div>
    </div>
</div>

<div id="loginOverlay" class="login-screen">
    <div class="glass-card p-4 text-center" style="max-width: 350px; width: 90%;">
        <h3 class="mb-4">๐ ุชุณุฌูู ุงูุฏุฎูู</h3>
        <input type="password" id="appPassword" class="form-control glass-input mb-3 text-center" placeholder="ุฃุฏุฎู ุฑูุฒ ุงูุฏุฎูู">
        <button class="btn btn-warning w-100 fw-bold" onclick="checkLogin()">ุฏุฎูู ๐</button>
    </div>
</div>

<div class="container py-4">

    <div id="tab-home" class="tab-content active">
        <h3 class="text-center mb-4">๐ ุณุฌู ุงูุญุถูุฑ ูุงูุฑูุงุชุจ</h3>
        
        <div class="glass-card p-3">
            <h6 class="mb-2">ุชุณุฌูู ุญุถูุฑ ูููู:</h6>
            <div class="mb-2">
                <input type="date" id="attendanceDate" class="form-control glass-input">
            </div>
            <div class="input-group mb-2">
                <select id="workerAttendanceSelect" class="form-select glass-select">
                    <option value="">ุงุฎุชุฑ ุนุงููุงู...</option>
                </select>
                <button class="btn btn-warning" onclick="addToTempList()">+ ุฅุถุงูุฉ ูููุงุฆูุฉ</button>
            </div>
            
            <div id="tempWorkersDisplay" class="selected-workers-list mb-3"></div>
            
            <button class="btn btn-success w-100 fw-bold" onclick="saveBatchAttendance()">ุญูุธ ุงูุญุถูุฑ โ</button>
        </div>

        <div class="glass-card p-3 text-center mb-3">
            <h6 class="mb-2 text-white-50">ุตุงูู ุงูุฑุตูุฏ ุงูููู (ูุณุชุญูุงุช ุงูุนูุงู)</h6>
            <h2 id="grandTotalDisplay" class="fw-bold m-0 text-white">0 ุฏ.ุน</h2>
            <small id="connectionStatus" class="badge bg-secondary mt-1">ุฌุงุฑู ุงูุชุญูู ูู ุงูุดุจูุฉ...</small>
        </div>

        <div class="glass-card p-3">
            <div class="table-responsive">
                <table class="table table-glass text-center mb-0">
                    <thead>
                        <tr>
                            <th>ุงูุงุณู</th>
                            <th>ุฃูุงู ุงูุนูู</th>
                            <th>ุงูุฑุตูุฏ ุงูุตุงูู</th>
                            <th>ุงูุชูุงุตูู</th>
                        </tr>
                    </thead>
                    <tbody id="mainTableBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <div id="tab-notes" class="tab-content">
        <h3 class="text-center mb-4">๐ ุงูููุงุญุธุงุช</h3>
        
        <button class="btn btn-dark w-100 mb-3 border-secondary" onclick="toggleSecretSection()">๐ ููุงุญุธุฉ ุณุฑูุฉ / ุงูุฎุฒูุฉ</button>

        <div id="secretSection" class="glass-card p-3 mb-3" style="display: none; border: 1px solid #ffc107;">
            <h5 class="text-center text-warning mb-3">๐ฐ ุงูุฎุฒูุฉ ุงูุณุฑูุฉ</h5>
            
            <div class="text-center mb-3 p-2" style="background: rgba(0,0,0,0.3); border-radius: 10px;">
                <small class="text-white-50">ุงููุจูุบ ุงูููู ุงููุชุจูู</small>
                <h2 id="secretTotalDisplay" class="fw-bold text-warning m-0">0 ุฏ.ุน</h2>
            </div>

            <hr class="border-warning">

            <label class="text-white-50 mb-1">ุฅุถุงูุฉ ุฑุฃุณ ูุงู (ุดุญู ุงูุฎุฒูุฉ):</label>
            <div class="input-group mb-3">
                <input type="number" id="addSecretAmount" class="form-control glass-input" placeholder="ุงููุจูุบ ููุฅุถุงูุฉ">
                <button class="btn btn-success" onclick="addToSecretTotal()">+ ุดุญู</button>
            </div>

            <hr class="border-white">

            <label class="text-white-50 mb-1">ุตุฑู / ุชูููุต ูู ุงูุฎุฒูุฉ:</label>
            <input type="text" id="deductNoteName" class="form-control glass-input mb-2" placeholder="ุงุณู ุงูููุงุญุธุฉ / ุณุจุจ ุงูุตุฑู">
            <input type="number" id="deductAmount" class="form-control glass-input mb-2" placeholder="ูุจูุบ ุงูุตุฑู">
            <button class="btn btn-danger w-100 mb-3" onclick="deductFromSecret()">๐ป ุชูููุต ูู ุงููุจูุบ</button>

            <h6 class="text-white-50">ุณุฌู ุงูุนูููุงุช:</h6>
            <ul id="secretLogsList" class="list-group" style="max-height: 200px; overflow-y: auto;"></ul>
        </div>
        
        <div class="glass-card p-3">
            <label class="mb-2">ุฅุถุงูุฉ ููุงุญุธุฉ ุฌุฏูุฏุฉ:</label>
            <textarea id="noteText" class="form-control glass-input mb-2" rows="2" placeholder="ุงูุชุจ ุงูููุงุญุธุฉ ููุง..."></textarea>
            <button class="btn btn-primary w-100" onclick="addNote()">ุญูุธ ุงูููุงุญุธุฉ</button>
        </div>

        <div id="notesList"></div>
    </div>

    <div id="tab-workers" class="tab-content">
        <h3 class="text-center mb-4">๐ท ุฅุฏุงุฑุฉ ุงูุนูุงู ูุงูุณูู</h3>
        <div class="glass-card p-2" id="manageWorkersList"></div>
    </div>

    <div id="tab-add" class="tab-content">
        <h3 class="text-center mb-4">โ ุฅุถุงูุฉ ุนุงูู</h3>
        <div class="glass-card p-4">
            <div class="mb-4">
                <label class="form-label">ุงุณู ุงูุนุงูู:</label>
                <input type="text" id="newWorkerName" class="form-control glass-input form-control-lg" placeholder="ุงูุชุจ ุงูุงุณู ููุง...">
            </div>
            <div class="mb-4">
                <label class="form-label">ูููุฉ ุงูููููุฉ (ุฏ.ุน):</label>
                <input type="number" id="newWorkerWage" class="form-control glass-input" placeholder="ูุซูุงู 25000">
            </div>
            <button class="btn btn-light w-100 btn-lg fw-bold" style="color: #333;" onclick="addNewWorker()">ุญูุธ ุงูุนุงูู โ</button>
        </div>
    </div>

</div>

<div class="modal fade" id="loanModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content modal-content-glass">
            <div class="modal-header border-bottom-0">
                <h5 class="modal-title">๐ฐ ุฅุฏุงุฑุฉ ุงูุณูู: <span id="loanWorkerName"></span></h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body text-center">
                <h4 class="mb-2">ูุฌููุน ุงูุณูู</h4>
                <h2 id="totalLoanDisplay" class="text-white fw-bold mb-4">0 ุฏ.ุน</h2>
                
                <hr class="border-light">
                
                <h6 class="text-start">ุฅุถุงูุฉ ุณููุฉ ุฌุฏูุฏุฉ:</h6>
                <input type="date" id="loanDate" class="form-control glass-input mb-2">
                <input type="number" id="loanAmount" class="form-control glass-input mb-2" placeholder="ุงููุจูุบ ุจุงูุฏููุงุฑ ุงูุนุฑุงูู">
                <button class="btn btn-warning w-100 mb-3 fw-bold" onclick="saveLoan()">ุญูุธ ุงูุณููุฉ</button>
                
                <div class="table-responsive mb-3" style="max-height: 200px; overflow-y: auto;">
                    <table class="table table-glass table-sm text-center">
                        <thead><tr><th>ุงูุชุงุฑูุฎ</th><th>ุงููุจูุบ</th></tr></thead>
                        <tbody id="loanListBody"></tbody>
                    </table>
                </div>

                <button class="btn btn-outline-danger w-100" onclick="resetLoans()">๐ ุชุตููุฑ ุงูุณูู</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="detailsModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content modal-content-glass">
            <div class="modal-header border-bottom-0">
                <h5 class="modal-title">ุชูุงุตูู ุงูุฑุตูุฏ ูุงูุญุถูุฑ</h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <button id="resetAttendanceBtn" class="btn btn-danger w-100 mb-3 fw-bold">๐๏ธ ุชุตููุฑ ุฑุตูุฏ ุงูุญุถูุฑ ุจุงููุงูู</button>

                <div class="text-center mb-3 p-2" style="background: rgba(255,255,255,0.1); border-radius: 10px;">
                    <small class="text-white-50">ูุฌููุน ุงูุฑุตูุฏ (ูู ุงูุนูู)</small>
                    <h2 id="detailsTotalBalance" class="fw-bold text-success m-0">0 ุฏ.ุน</h2>
                </div>
                
                <h6 class="mb-2">ุชูุงุฑูุฎ ุงูุญุถูุฑ:</h6>
                <ul class="list-group" id="workDatesList" style="max-height: 300px; overflow-y: auto;"></ul>
            </div>
        </div>
    </div>
</div>

<nav class="bottom-nav">
    <div class="nav-item active" onclick="switchTab('home', this)">
        <span class="nav-icon">๐</span>
        <span class="nav-text">ุงูุฑุฆูุณูุฉ</span>
    </div>
    <div class="nav-item" onclick="switchTab('notes', this)">
        <span class="nav-icon">๐</span>
        <span class="nav-text">ููุงุญุธุฉ</span>
    </div>
    <div class="nav-item" onclick="switchTab('workers', this)">
        <span class="nav-icon">๐ท</span>
        <span class="nav-text">ุงูุนูุงู</span>
    </div>
    <div class="nav-item" onclick="switchTab('add', this)">
        <span class="nav-icon">โ</span>
        <span class="nav-text">ุฅุถุงูุฉ</span>
    </div>
</nav>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script type="module" src="script.js"></script>
</body>
</html>
